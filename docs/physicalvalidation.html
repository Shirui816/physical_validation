

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>physicalvalidation package &mdash; physicalvalidation 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="physicalvalidation 0.1 documentation" href="index.html"/>
        <link rel="next" title="physicalvalidation.data subpackage" href="physicalvalidation.data.html"/>
        <link rel="prev" title="Introduction" href="userguide.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> physicalvalidation
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="userguide.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#simulation-data">Simulation Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#kinetic-energy-validation">Kinetic energy validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#ensemble-validation">Ensemble validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#integrator-validation">Integrator validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Package reference:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">physicalvalidation package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-physicalvalidation.kineticenergy">physicalvalidation.kineticenergy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physicalvalidation.ensemble">physicalvalidation.ensemble module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physicalvalidation.integrator">physicalvalidation.integratorconvergence module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="physicalvalidation.data.html">physicalvalidation.data subpackage</a></li>
<li class="toctree-l1"><a class="reference internal" href="physicalvalidation.util.html">physicalvalidation.util subpackage</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">physicalvalidation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>physicalvalidation package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/physicalvalidation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-physicalvalidation">
<span id="physicalvalidation-package"></span><h1>physicalvalidation package<a class="headerlink" href="#module-physicalvalidation" title="Permalink to this headline">¶</a></h1>
<p>Physical validation suite for MD simulations</p>
<div class="section" id="module-physicalvalidation.kineticenergy">
<span id="physicalvalidation-kineticenergy-module"></span><h2>physicalvalidation.kineticenergy module<a class="headerlink" href="#module-physicalvalidation.kineticenergy" title="Permalink to this headline">¶</a></h2>
<p>The <cite>kineticenergy</cite> module is part of the physicalvalidation package, and
consists of checks of the kinetic energy distribution and its
equipartition.</p>
<dl class="function">
<dt id="physicalvalidation.kineticenergy.check_mb_ensemble">
<code class="descclassname">physicalvalidation.kineticenergy.</code><code class="descname">check_mb_ensemble</code><span class="sig-paren">(</span><em>data</em>, <em>alpha</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physicalvalidation/kineticenergy.html#check_mb_ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physicalvalidation.kineticenergy.check_mb_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a kinetic energy trajectory is Maxwell-Boltzmann distributed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference internal" href="physicalvalidation.data.html#physicalvalidation.data.simulation_data.SimulationData" title="physicalvalidation.data.simulation_data.SimulationData"><em>SimulationData</em></a>) – Simulation data object</li>
<li><strong>alpha</strong> (<em>float</em>) – Confidence. TODO: Check proper statistical definition.</li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Print result details. Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> – True if hypothesis stands, false if hypothesis got rejected.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function checks whether the hypothesis that a sample
of kinetic energies is Maxwell-Boltzmann distributed given a specific
target temperature and the number of degrees of freedom in the system,</p>
<div class="math">
\[P(K) \sim K^{N/2} e^{-\beta K} \, ,\]</div>
<p>holds under a given confidence level <span class="math">\(\alpha\)</span>.
The check is performed using the Kolmogorov-Smirnov test provided by
<a class="reference external" href="https://docs.scipy.org/doc/scipy-0.19.0/reference/generated/scipy.stats.kstest.html">scipy.stats.kstest</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Kolmogorov-Smirnov is known to have two weaknesses.</p>
<ol class="last arabic simple">
<li>The test is more sensitive towards deviations around the center
of the distribution than at its tails. We deem this to be acceptable
for most MD applications, but be wary if yours is sensible to the
kinetic distribution tails.</li>
<li>The test is not valid if its parameters are guessed from the data
set. Using the target temperature of the MD simulation as an input
is therefore perfectly valid, but using the average temperature
over the trajectory as an input to the test can potentially
invalidate it.</li>
</ol>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Can we check the influence of sample size on test results?</p>
</div>
</dd></dl>

<dl class="function">
<dt id="physicalvalidation.kineticenergy.check_equipartition">
<code class="descclassname">physicalvalidation.kineticenergy.</code><code class="descname">check_equipartition</code><span class="sig-paren">(</span><em>data</em>, <em>dtemp=0.1</em>, <em>temp=None</em>, <em>alpha=0.05</em>, <em>molec_groups=None</em>, <em>random_divisions=0</em>, <em>random_groups=0</em>, <em>verbosity=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physicalvalidation/kineticenergy.html#check_equipartition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physicalvalidation.kineticenergy.check_equipartition" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the equipartition of a simulation trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference internal" href="physicalvalidation.data.html#physicalvalidation.data.simulation_data.SimulationData" title="physicalvalidation.data.simulation_data.SimulationData"><em>SimulationData</em></a>) – Simulation data object</li>
<li><strong>dtemp</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of temperature deviation tolerated between groups. Default: 0.05 (5%).</li>
<li><strong>temp</strong> (<em>float</em><em>, </em><em>optional</em>) – Target temperature of the simulation. If None, the kinetic energies will not be
tested for Maxwell-Boltzmann distribution, but only compared amongst each others.
Default: None.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Confidence for Maxwell-Boltzmann test. Default: 0.05 (5%).</li>
<li><strong>molec_groups</strong> (<em>list of array-like</em><em> (</em><em>ngroups x ?</em><em>)</em><em>, </em><em>optional</em>) – List of 1d arrays containing molecule indeces defining groups. Useful to pre-define
groups of molecules (e.g. solute / solvent, liquid mixture species, …). If None,
no pre-defined molecule groups will be tested. Default: None.</li>
<li><strong>random_divisions</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of random division tests attempted. Default: 0 (random division tests off).</li>
<li><strong>random_groups</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of groups the system is randomly divided in. Default: 2.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level, where 0 is quiet and 3 very chatty. Default: 2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> – Number of equipartition violations. Tune up verbosity for details.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function compares the kinetic energy between groups of degrees of
freedom. Theoretically, the kinetic energy is expected (via the
equipartition theorem) to be equally distributed over all degrees of
freedom. In practice, deviations of temperature between groups of
degrees of freedom up to several degrees K are routinely observed.
Larger deviations can, however, hint to misbehaving simulations, such
as, e.g., frozen degrees of freedom, lack of energy exchange between
degrees of freedom, and transfer of heat from faster to slower
oscillating degrees of freedom.</p>
<p>Splitting of degrees of freedom is done both on a sub-molecular and on
a molecular level. On a sub-molecular level, the degrees of freedom of
a molecule can be partitioned into rigid-body contributions
(translation of the center-of-mass, rotation around the
center-of-mass) and intra-molecular contributions. On a molecular
level, the single molecules of the system can be divided in groups,
either by function (solute / solvent, different species of liquid
mixtures, …) or randomly.</p>
<p><cite>check_equipartition()</cite> compares the partitioned temperatures of the
entire system and, optionally, of predefined or randomly separated
groups.</p>
<p>Note: In theory, the kinetic energy of the subgroups are expected to
be individually Maxwell-Boltzmann distributed. As this is seldomly
holding in practice (see above), <cite>check_equipartition()</cite> is by
default checking only for abnormal deviations in average temperatures.
The more strict Maxwell-Boltzmann testing can be invoked by giving the
target temperature <cite>temp</cite> as an input.</p>
</dd></dl>

</div>
<div class="section" id="module-physicalvalidation.ensemble">
<span id="physicalvalidation-ensemble-module"></span><h2>physicalvalidation.ensemble module<a class="headerlink" href="#module-physicalvalidation.ensemble" title="Permalink to this headline">¶</a></h2>
<p>This software allows users to perform statistical test to determine if a
given molecular simulation is consistent with the thermodynamic ensemble
it is performed in.</p>
<p>Users should cite the JCTC paper: Shirts, “M. R. Simple Quantitative
Tests to Validate Sampling from Thermodynamic Ensembles”,
J. Chem. Theory Comput., 2013, 9 (2), pp 909–926,
<a class="reference external" href="http://dx.doi.org/10.1021/ct300688p">http://dx.doi.org/10.1021/ct300688p</a></p>
<dl class="function">
<dt id="physicalvalidation.ensemble.check_nvt">
<code class="descclassname">physicalvalidation.ensemble.</code><code class="descname">check_nvt</code><span class="sig-paren">(</span><em>data_sim_one</em>, <em>data_sim_two</em>, <em>total_energy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physicalvalidation/ensemble.html#check_nvt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physicalvalidation.ensemble.check_nvt" title="Permalink to this definition">¶</a></dt>
<dd><p>Check NVT ensemble.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_sim_one</strong> (<a class="reference internal" href="physicalvalidation.data.html#physicalvalidation.data.simulation_data.SimulationData" title="physicalvalidation.data.simulation_data.SimulationData"><em>SimulationData</em></a>) – </li>
<li><strong>data_sim_two</strong> (<a class="reference internal" href="physicalvalidation.data.html#physicalvalidation.data.simulation_data.SimulationData" title="physicalvalidation.data.simulation_data.SimulationData"><em>SimulationData</em></a>) – </li>
<li><strong>total_energy</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physicalvalidation.ensemble.check_npt">
<code class="descclassname">physicalvalidation.ensemble.</code><code class="descname">check_npt</code><span class="sig-paren">(</span><em>data_sim_one</em>, <em>data_sim_two</em>, <em>total_energy=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physicalvalidation/ensemble.html#check_npt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physicalvalidation.ensemble.check_npt" title="Permalink to this definition">¶</a></dt>
<dd><p>Check NPT ensemble.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_sim_one</strong> (<a class="reference internal" href="physicalvalidation.data.html#physicalvalidation.data.simulation_data.SimulationData" title="physicalvalidation.data.simulation_data.SimulationData"><em>SimulationData</em></a>) – </li>
<li><strong>data_sim_two</strong> (<a class="reference internal" href="physicalvalidation.data.html#physicalvalidation.data.simulation_data.SimulationData" title="physicalvalidation.data.simulation_data.SimulationData"><em>SimulationData</em></a>) – </li>
<li><strong>total_energy</strong> (<em>bool</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-physicalvalidation.integrator">
<span id="physicalvalidation-integratorconvergence-module"></span><h2>physicalvalidation.integratorconvergence module<a class="headerlink" href="#module-physicalvalidation.integrator" title="Permalink to this headline">¶</a></h2>
<p>integratorconvergence.py
&#64;author Pascal T. Merz</p>
<dl class="function">
<dt id="physicalvalidation.integrator.convergence">
<code class="descclassname">physicalvalidation.integrator.</code><code class="descname">convergence</code><span class="sig-paren">(</span><em>simulations</em>, <em>convergence_test=&lt;function simple_convergence_test&gt;</em>, <em>verbose=True</em>, <em>slope=False</em>, <em>tol=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physicalvalidation/integrator.html#convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physicalvalidation.integrator.convergence" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>simulations</strong> (<em>list of SimulationData</em>) – </li>
<li><strong>convergence_test</strong> (<em>callable</em><em>, </em><em>optional</em>) – </li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – </li>
<li><strong>slope</strong> (<em>bool</em><em>, </em><em>optional</em>) – </li>
<li><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="physicalvalidation.data.html" class="btn btn-neutral float-right" title="physicalvalidation.data subpackage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="userguide.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Pascal T. Merz, Michael R. Shirts.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>