

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>physical_validation.util subpackage &mdash; physical_validation 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="physical_validation 0.1 documentation" href="index.html"/>
        <link rel="prev" title="physical_validation.data subpackage" href="physical_validation.data.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> physical_validation
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="userguide.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#examples-folder"><cite>examples/</cite> folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#simulation-data">Simulation data</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#kinetic-energy-validation">Kinetic energy validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#ensemble-validation">Ensemble validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html#integrator-validation">Integrator Validation</a></li>
</ul>
<p class="caption"><span class="caption-text">Package reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="physical_validation.html">physical_validation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="physical_validation.data.html">physical_validation.data subpackage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">physical_validation.util subpackage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-physical_validation.util.checkensemble">physical_validation.util.checkensemble module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physical_validation.util.error">physical_validation.util.error module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physical_validation.util.gromacs_interface">physical_validation.util.gromacs_interface module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physical_validation.util.integrator">physical_validation.util.integrator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physical_validation.util.kinetic_energy">physical_validation.util.kinetic_energy module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-physical_validation.util.timeseries">physical_validation.util.timeseries module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">physical_validation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>physical_validation.util subpackage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/physical_validation.util.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="physical-validation-util-subpackage">
<h1>physical_validation.util subpackage<a class="headerlink" href="#physical-validation-util-subpackage" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This subpackage is intended for internal use. Documentation
and input validation is reduced.</p>
</div>
<div class="section" id="module-physical_validation.util.checkensemble">
<span id="physical-validation-util-checkensemble-module"></span><h2>physical_validation.util.checkensemble module<a class="headerlink" href="#module-physical_validation.util.checkensemble" title="Permalink to this headline">¶</a></h2>
<p>This file largely corresponds to the checkensemble.py code originally
published on <a class="reference external" href="https://github.com/shirtsgroup/checkensemble">https://github.com/shirtsgroup/checkensemble</a>. It now serves
as the low-level functionality of the high-level module
<a class="reference internal" href="physical_validation.html#module-physical_validation.ensemble" title="physical_validation.ensemble"><code class="xref py py-mod docutils literal"><span class="pre">physical_validation.ensemble</span></code></a>.</p>
<dl class="function">
<dt id="physical_validation.util.checkensemble.check_twodtype">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">check_twodtype</code><span class="sig-paren">(</span><em>type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#check_twodtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.check_twodtype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.PrepConversionFactors">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">PrepConversionFactors</code><span class="sig-paren">(</span><em>eunits='kJ/mol'</em>, <em>punits='bar'</em>, <em>vunits='nm^3'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#PrepConversionFactors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.PrepConversionFactors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.PrepStrings">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">PrepStrings</code><span class="sig-paren">(</span><em>type</em>, <em>vunits='kT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#PrepStrings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.PrepStrings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.PrepInputs">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">PrepInputs</code><span class="sig-paren">(</span><em>N_k</em>, <em>conversions</em>, <em>type='dbeta-constV'</em>, <em>beta=None</em>, <em>beta_ave=None</em>, <em>P=None</em>, <em>P_ave=None</em>, <em>mu=None</em>, <em>mu_ave=None</em>, <em>U_kn=None</em>, <em>V_kn=None</em>, <em>N_kn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#PrepInputs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.PrepInputs" title="Permalink to this definition">¶</a></dt>
<dd><p>useg can be either &#8220;scale&#8221;, where uncertainties are scaled, or &#8220;subsample&#8221; resulting in subsampled data.</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.LogLikelihood">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">LogLikelihood</code><span class="sig-paren">(</span><em>x</em>, <em>N_k</em>, <em>const</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#LogLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.LogLikelihood" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.dLogLikelihood">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">dLogLikelihood</code><span class="sig-paren">(</span><em>x</em>, <em>N_k</em>, <em>const</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#dLogLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.dLogLikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative with respect to the parameters, to aid the minimization.</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.d2LogLikelihood">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">d2LogLikelihood</code><span class="sig-paren">(</span><em>x</em>, <em>N_k</em>, <em>const</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#d2LogLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.d2LogLikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>beta = const[0]
pave = const[1]</p>
<p>if D = M + beta*x[0] + x[1]*U
I = sum_{i=1}^N [[-beta^2/S,-beta*U/S],[-beta*U/S,-U^2/S]] where S = [(1+exp(-D))*(1+exp(D))]</p>
<p>if D = M + beta*x[0] + x[1]*U + x[2]*V
I = sum_{i=1}^N [[-beta^2/S,-beta*U/S,-beta*V/S],[-beta*U/S,-U^2/S,-U*V/S],[-beta*V/S,-U*V^2/S,-V^2/S]] where S = [(1+exp(-D))*(1+exp(D))]</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.SolveMaxLike">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">SolveMaxLike</code><span class="sig-paren">(</span><em>x</em>, <em>N_k</em>, <em>const</em>, <em>v</em>, <em>tol=1e-10</em>, <em>maxiter=20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#SolveMaxLike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.SolveMaxLike" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.MaxLikeUncertain">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">MaxLikeUncertain</code><span class="sig-paren">(</span><em>x</em>, <em>N_k</em>, <em>const</em>, <em>v</em>, <em>vave</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#MaxLikeUncertain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.MaxLikeUncertain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.MaxLikeParams">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">MaxLikeParams</code><span class="sig-paren">(</span><em>N_k</em>, <em>dp</em>, <em>const</em>, <em>v</em>, <em>df=0</em>, <em>analytic_uncertainty=False</em>, <em>g=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#MaxLikeParams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.MaxLikeParams" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.logsum">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">logsum</code><span class="sig-paren">(</span><em>a_n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#logsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.logsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of a sum of exponentiated terms exp(a_n) in a numerically-stable manner:</p>
<blockquote>
<div>logsum a_n = max_arg + log sum_{n=1}^N exp[a_n - max_arg]</div></blockquote>
<p>where max_arg = max_n a_n.  This is mathematically (but not numerically) equivalent to</p>
<blockquote>
<div>logsum a_n = log sum_{n=1}^N exp[a_n]</div></blockquote>
<dl class="docutils">
<dt>ARGUMENTS</dt>
<dd>a_n (numpy array) - a_n[n] is the nth exponential argument</dd>
<dt>RETURNS</dt>
<dd>log_sum (float) - the log of the sum of exponentiated a_n, log (sum_n exp(a_n))</dd>
</dl>
<p>EXAMPLE</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.BARzero">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">BARzero</code><span class="sig-paren">(</span><em>w_F</em>, <em>w_R</em>, <em>DeltaF</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#BARzero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.BARzero" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>ARGUMENTS</dt>
<dd><dl class="first docutils">
<dt>w_F (numpy.array) - w_F[t] is the forward work value from snapshot t.</dt>
<dd>t = 0...(T_F-1)  Length T_F is deduced from vector.</dd>
<dt>w_R (numpy.array) - w_R[t] is the reverse work value from snapshot t.</dt>
<dd>t = 0...(T_R-1)  Length T_R is deduced from vector.</dd>
</dl>
<p class="last">DeltaF (float) - Our current guess</p>
</dd>
</dl>
<p>RETURNS</p>
<blockquote>
<div>fzero - a variable that is zeroed when DeltaF satisfies BAR.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.BAR">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">BAR</code><span class="sig-paren">(</span><em>w_F</em>, <em>w_R</em>, <em>DeltaF=0.0</em>, <em>maximum_iterations=500</em>, <em>relative_tolerance=1e-10</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#BAR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.BAR" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute free energy difference using the Bennett acceptance ratio (BAR) method using false position</p>
<dl class="docutils">
<dt>ARGUMENTS</dt>
<dd><dl class="first last docutils">
<dt>w_F (numpy.array) - w_F[t] is the forward work value from snapshot t.</dt>
<dd>t = 0...(T_F-1)  Length T_F is deduced from vector.</dd>
<dt>w_R (numpy.array) - w_R[t] is the reverse work value from snapshot t.</dt>
<dd>t = 0...(T_R-1)  Length T_R is deduced from vector.</dd>
</dl>
</dd>
</dl>
<p>OPTIONAL ARGUMENTS</p>
<blockquote>
<div>DeltaF (float) - DeltaF can be set to initialize the free energy difference with a guess (default 0.0)
maximum_iterations (int) - can be set to limit the maximum number of iterations performed (default 500)
relative_tolerance (float) - can be set to determine the relative tolerance convergence criteria (defailt 1.0e-5)
verbose (boolean) - should be set to True if verbse debug output is desired (default False)</div></blockquote>
<p>RETURNS</p>
<blockquote>
<div>[DeltaF, dDeltaF] where dDeltaF is the estimated std dev uncertainty</div></blockquote>
<p>REFERENCE</p>
<blockquote>
<div>[1] Shirts MR, Bair E, Hooker G, and Pande VS. Equilibrium free energies from nonequilibrium
measurements using maximum-likelihood methods. PRL 91(14):140601, 2003.</div></blockquote>
<p>EXAMPLES</p>
<p>Compute free energy difference between two specified samples of work values.</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.Print1DStats">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">Print1DStats</code><span class="sig-paren">(</span><em>title</em>, <em>type</em>, <em>fitvals</em>, <em>convert</em>, <em>trueslope</em>, <em>const</em>, <em>dfitvals='N/A'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#Print1DStats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.Print1DStats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.Print2DStats">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">Print2DStats</code><span class="sig-paren">(</span><em>title</em>, <em>type</em>, <em>fitvals</em>, <em>kB</em>, <em>convertback</em>, <em>trueslope</em>, <em>const</em>, <em>dfitvals='N/A'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#Print2DStats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.Print2DStats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.PrintPicture">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">PrintPicture</code><span class="sig-paren">(</span><em>xaxis</em>, <em>true</em>, <em>y</em>, <em>dy</em>, <em>fit</em>, <em>type</em>, <em>name</em>, <em>figname</em>, <em>fittype</em>, <em>vunits='kT'</em>, <em>show=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#PrintPicture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.PrintPicture" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.GenHistogramProbs">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">GenHistogramProbs</code><span class="sig-paren">(</span><em>N_k</em>, <em>bins</em>, <em>v</em>, <em>g</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#GenHistogramProbs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.GenHistogramProbs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.LinFit">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">LinFit</code><span class="sig-paren">(</span><em>bins, N_k, dp, const, v, df=0, analytic_uncertainty=False, bGraph=False, name='', figname='lin_figure', g=[1, 1], type='dbeta-constV', vunits='kT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#LinFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.LinFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.SolveNonLin">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">SolveNonLin</code><span class="sig-paren">(</span><em>f</em>, <em>df</em>, <em>a</em>, <em>data</em>, <em>ddata</em>, <em>xaxis</em>, <em>maxiter=20</em>, <em>tol=1e-10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#SolveNonLin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.SolveNonLin" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.ExpFit">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">ExpFit</code><span class="sig-paren">(</span><em>a</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#ExpFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.ExpFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.dExpFit">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">dExpFit</code><span class="sig-paren">(</span><em>a</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#dExpFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.dExpFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.NonLinFit">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">NonLinFit</code><span class="sig-paren">(</span><em>bins, N_k, dp, const, v, df=0, analytic_uncertainty=False, bGraph=False, name='', figname='nonlin_figure', tol=1e-10, g=[1, 1], type='dbeta-constV', vunits='kT'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#NonLinFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.NonLinFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.MaxwellBoltzFit">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">MaxwellBoltzFit</code><span class="sig-paren">(</span><em>bins</em>, <em>U</em>, <em>N</em>, <em>kT</em>, <em>figname</em>, <em>name=''</em>, <em>ndof=None</em>, <em>g=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#MaxwellBoltzFit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.MaxwellBoltzFit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.PrintData">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">PrintData</code><span class="sig-paren">(</span><em>xaxis</em>, <em>true</em>, <em>fit</em>, <em>collected</em>, <em>dcollected</em>, <em>type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#PrintData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.PrintData" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.checkensemble.ProbabilityAnalysis">
<code class="descclassname">physical_validation.util.checkensemble.</code><code class="descname">ProbabilityAnalysis</code><span class="sig-paren">(</span><em>N_k, type='dbeta-constV', T_k=None, P_k=None, mu_k=None, U_kn=None, V_kn=None, N_kn=None, kB=0.0083144624, title=None, figname=None, nbins=40, bMaxLikelihood=True, bLinearFit=True, bNonLinearFit=True, reptype=None, nboots=200, g=[1, 1], reps=None, cuttails=0.001, bMaxwell=False, eunits='kJ/mol', vunits='nm^3', punits='bar', seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/checkensemble.html#ProbabilityAnalysis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.checkensemble.ProbabilityAnalysis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-physical_validation.util.error">
<span id="physical-validation-util-error-module"></span><h2>physical_validation.util.error module<a class="headerlink" href="#module-physical_validation.util.error" title="Permalink to this headline">¶</a></h2>
<p>Module containing the custom exception classes for the physical_validation
package.</p>
<dl class="exception">
<dt id="physical_validation.util.error.PhysicalValidationError">
<em class="property">exception </em><code class="descclassname">physical_validation.util.error.</code><code class="descname">PhysicalValidationError</code><a class="reference internal" href="_modules/physical_validation/util/error.html#PhysicalValidationError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.error.PhysicalValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for exceptions in the physical_validation module.</p>
</dd></dl>

<dl class="exception">
<dt id="physical_validation.util.error.InputError">
<em class="property">exception </em><code class="descclassname">physical_validation.util.error.</code><code class="descname">InputError</code><span class="sig-paren">(</span><em>argument</em>, <em>message</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/error.html#InputError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.error.InputError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised for input errors</p>
</dd></dl>

<dl class="exception">
<dt id="physical_validation.util.error.ParserValueNotSetError">
<em class="property">exception </em><code class="descclassname">physical_validation.util.error.</code><code class="descname">ParserValueNotSetError</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/error.html#ParserValueNotSetError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.error.ParserValueNotSetError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised if a requested data value
was not set by the user previously</p>
</dd></dl>

</div>
<div class="section" id="module-physical_validation.util.gromacs_interface">
<span id="physical-validation-util-gromacs-interface-module"></span><h2>physical_validation.util.gromacs_interface module<a class="headerlink" href="#module-physical_validation.util.gromacs_interface" title="Permalink to this headline">¶</a></h2>
<p>GROMACS python interface.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is a mere place holder, as an official python API is
currently being developed by the gromacs development team. It is
probably neither especially elegant nor especially safe. Use of this
module in any remotely critical application is strongly discouraged.</p>
</div>
<dl class="class">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface">
<em class="property">class </em><code class="descclassname">physical_validation.util.gromacs_interface.</code><code class="descname">GromacsInterface</code><span class="sig-paren">(</span><em>exe=None</em>, <em>dp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.exe">
<code class="descname">exe</code><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.exe" title="Permalink to this definition">¶</a></dt>
<dd><p>exe is a string pointing to the gmx executable.</p>
</dd></dl>

<dl class="attribute">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.double">
<code class="descname">double</code><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.double" title="Permalink to this definition">¶</a></dt>
<dd><p>double is a bool defining whether the simulation was ran at double precision</p>
</dd></dl>

<dl class="method">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.get_quantities">
<code class="descname">get_quantities</code><span class="sig-paren">(</span><em>edr</em>, <em>quantities</em>, <em>cwd=None</em>, <em>begin=None</em>, <em>end=None</em>, <em>args=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.get_quantities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.get_quantities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.read_trr">
<code class="descname">read_trr</code><span class="sig-paren">(</span><em>trr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.read_trr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.read_trr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.read_gro">
<em class="property">static </em><code class="descname">read_gro</code><span class="sig-paren">(</span><em>gro</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.read_gro"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.read_gro" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.read_mdp">
<em class="property">static </em><code class="descname">read_mdp</code><span class="sig-paren">(</span><em>mdp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.read_mdp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.read_mdp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.read_system_from_top">
<em class="property">static </em><code class="descname">read_system_from_top</code><span class="sig-paren">(</span><em>top</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.read_system_from_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.read_system_from_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.grompp">
<code class="descname">grompp</code><span class="sig-paren">(</span><em>mdp</em>, <em>top</em>, <em>gro</em>, <em>tpr=None</em>, <em>cwd='.'</em>, <em>maxwarn=0</em>, <em>args=None</em>, <em>stdin=None</em>, <em>stdout=None</em>, <em>stderr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.grompp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.grompp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="physical_validation.util.gromacs_interface.GromacsInterface.mdrun">
<code class="descname">mdrun</code><span class="sig-paren">(</span><em>tpr</em>, <em>edr=None</em>, <em>deffnm=None</em>, <em>cwd='.'</em>, <em>args=None</em>, <em>stdin=None</em>, <em>stdout=None</em>, <em>stderr=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/gromacs_interface.html#GromacsInterface.mdrun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.gromacs_interface.GromacsInterface.mdrun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-physical_validation.util.integrator">
<span id="physical-validation-util-integrator-module"></span><h2>physical_validation.util.integrator module<a class="headerlink" href="#module-physical_validation.util.integrator" title="Permalink to this headline">¶</a></h2>
<p>This module contains low-level functionality of the
<cite>physical_validation.integrator</cite> module. The functions in this module should
generally not be called directly. Please use the high-level functions from
<cite>physical_validation.integrator</cite>.</p>
<dl class="function">
<dt id="physical_validation.util.integrator.calculate_rmsd">
<code class="descclassname">physical_validation.util.integrator.</code><code class="descname">calculate_rmsd</code><span class="sig-paren">(</span><em>data</em>, <em>time=None</em>, <em>slope=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/integrator.html#calculate_rmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.integrator.calculate_rmsd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.integrator.simple_convergence_test">
<code class="descclassname">physical_validation.util.integrator.</code><code class="descname">simple_convergence_test</code><span class="sig-paren">(</span><em>dts</em>, <em>rmsds</em>, <em>tol</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/integrator.html#simple_convergence_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.integrator.simple_convergence_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="physical_validation.util.integrator.check_convergence">
<code class="descclassname">physical_validation.util.integrator.</code><code class="descname">check_convergence</code><span class="sig-paren">(</span><em>const_traj</em>, <em>convergence_test=&lt;function simple_convergence_test&gt;</em>, <em>verbose=True</em>, <em>slope=False</em>, <em>tol=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/integrator.html#check_convergence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.integrator.check_convergence" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-physical_validation.util.kinetic_energy">
<span id="physical-validation-util-kinetic-energy-module"></span><h2>physical_validation.util.kinetic_energy module<a class="headerlink" href="#module-physical_validation.util.kinetic_energy" title="Permalink to this headline">¶</a></h2>
<p>This module contains low-level functionality of the
<cite>physical_validation.kinetic_energy</cite> module. The functions in this module
should generally not be called directly. Please use the high-level
functions from <cite>physical_validation.kinetic energy</cite>.</p>
<dl class="function">
<dt id="physical_validation.util.kinetic_energy.temperature">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">temperature</code><span class="sig-paren">(</span><em>kin</em>, <em>ndof</em>, <em>kb=0.008314</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the temperature acccording to the equipartition theorem.</p>
<div class="math">
\[T(K) = \frac{2K}{N k_B}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin</strong> (<em>float</em>) &#8211; Kinetic energy.</li>
<li><strong>ndof</strong> (<em>float</em>) &#8211; Number of degrees of freedom.</li>
<li><strong>kb</strong> (<em>float</em>) &#8211; Boltzmann constant <span class="math">\(k_B\)</span>. Default: 8.314e-3 (kJ/mol).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>temperature</strong> &#8211; Calculated temperature.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.check_mb_ensemble">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">check_mb_ensemble</code><span class="sig-paren">(</span><em>kin</em>, <em>temp</em>, <em>ndof</em>, <em>alpha</em>, <em>kb=0.008314</em>, <em>verbose=False</em>, <em>plot=False</em>, <em>plot_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#check_mb_ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.check_mb_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a kinetic energy trajectory is Maxwell-Boltzmann distributed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin</strong> (<em>array-like</em>) &#8211; Kinetic energy snapshots of the system.</li>
<li><strong>temp</strong> (<em>float</em>) &#8211; Target temperature of the system. Used to construct the
Maxwell-Boltzmann distribution.</li>
<li><strong>ndof</strong> (<em>float</em>) &#8211; Number of degrees of freedom in the system. Used to construct the
Maxwell-Boltzmann distribution.</li>
<li><strong>alpha</strong> (<em>float</em>) &#8211; Confidence. TODO: Check proper statistical definition.</li>
<li><strong>kb</strong> (<em>float</em>) &#8211; Boltzmann constant <span class="math">\(k_B\)</span>. Default: 8.314e-3 (kJ/mol).</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; Print result details. Default: False.</li>
<li><strong>plot</strong> (<em>bool</em>) &#8211; Only for debug - prints a plottable file.</li>
<li><strong>plot_name</strong> (<em>string</em>) &#8211; Only for debug - the name of the file to write the plotting data to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> &#8211; True if hypothesis stands, false if hypothesis got rejected.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-func docutils literal"><span class="pre">physical_validation.kinetic_energy.check_mb_ensemble()</span></code></dt>
<dd>High-level version</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.check_equipartition">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">check_equipartition</code><span class="sig-paren">(</span><em>positions</em>, <em>velocities</em>, <em>masses</em>, <em>molec_idx</em>, <em>molec_nbonds</em>, <em>natoms</em>, <em>nmolecs</em>, <em>nframes</em>, <em>ndof_reduction_tra=0</em>, <em>ndof_reduction_rot=0</em>, <em>dtemp=0.1</em>, <em>temp=None</em>, <em>alpha=0.05</em>, <em>molec_groups=None</em>, <em>random_divisions=0</em>, <em>random_groups=2</em>, <em>verbosity=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#check_equipartition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.check_equipartition" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the equipartition of a simulation trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>positions</strong> (<em>array-like</em><em> (</em><em>nframes x natoms x 3</em><em>)</em><em></em>) &#8211; 3d array containing the positions of all atoms for all frames</li>
<li><strong>velocities</strong> (<em>array-like</em><em> (</em><em>nframes x natoms x 3</em><em>)</em><em></em>) &#8211; 3d array containing the velocities of all atoms for all frames</li>
<li><strong>masses</strong> (<em>array-like</em><em> (</em><em>natoms x 1</em><em>)</em><em></em>) &#8211; 1d array containing the masses of all atoms</li>
<li><strong>molec_idx</strong> (<em>array-like</em><em> (</em><em>nmolecs x 1</em><em>)</em><em></em>) &#8211; Index of first atom for every molecule</li>
<li><strong>molec_nbonds</strong> (<em>array-like</em><em> (</em><em>nmolecs x 1</em><em>)</em><em></em>) &#8211; Number of bonds for every molecule</li>
<li><strong>natoms</strong> (<em>int</em>) &#8211; Number of atoms in the system</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Number of molecules in the system</li>
<li><strong>nframes</strong> (<em>int</em>) &#8211; Number of frames contained in the <cite>positions</cite> and <cite>velocities</cite>
vectors</li>
<li><strong>ndof_reduction_tra</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of center-of-mass translational degrees of freedom to
remove. Default: 0.</li>
<li><strong>ndof_reduction_rot</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of center-of-mass rotational degrees of freedom to remove.
Default: 0.</li>
<li><strong>dtemp</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Fraction of temperature deviation tolerated between groups.
Default: 0.05 (5%).</li>
<li><strong>temp</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Target temperature of the simulation. If None, the kinetic
energies will not be tested for Maxwell-Boltzmann distribution,
but only compared amongst each others. Default: None.</li>
<li><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Confidence for Maxwell-Boltzmann test. Default: 0.05 (5%).</li>
<li><strong>molec_groups</strong> (<em>list of array-like</em><em> (</em><em>ngroups x ?</em><em>)</em><em></em><em>, </em><em>optional</em>) &#8211; List of 1d arrays containing molecule indeces defining groups.
Useful to pre-define groups of molecules (e.g. solute / solvent,
liquid mixture species, ...). If None, no pre-defined molecule
groups will be tested. Default: None.</li>
<li><strong>random_divisions</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of random division tests attempted. Default: 0 (random
division tests off).</li>
<li><strong>random_groups</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Number of groups the system is randomly divided in. Default: 2.</li>
<li><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Verbosity level, where 0 is quiet and 3 very chatty. Default: 2.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> &#8211; Number of equipartition violations. Tune up verbosity for details.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><code class="xref py py-func docutils literal"><span class="pre">physical_validation.kinetic_energy.check_equipartition()</span></code></dt>
<dd>High-level version</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.calc_system_ndof">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">calc_system_ndof</code><span class="sig-paren">(</span><em>natoms</em>, <em>nmolecs</em>, <em>nbonds</em>, <em>stop_com_tra</em>, <em>stop_com_rot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#calc_system_ndof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.calc_system_ndof" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total / translational / rotational &amp; internal /
rotational / internal degrees of freedom of the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>natoms</strong> (<em>int</em>) &#8211; Total number of atoms in the system</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system</li>
<li><strong>nbonds</strong> (<em>int</em>) &#8211; Total number of bonds in the system</li>
<li><strong>stop_com_tra</strong> (<em>bool</em>) &#8211; Was the center-of-mass translation removed during the simulation?</li>
<li><strong>stop_com_rot</strong> (<em>bool</em>) &#8211; Was the center-of-mass translation removed during the simulation?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ndof</strong> &#8211; Dictionary containing the degrees of freedom.
Keys: [&#8216;tot&#8217;, &#8216;tra&#8217;, &#8216;rni&#8217;, &#8216;rot&#8217;, &#8216;int&#8217;]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.calc_ndof">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">calc_ndof</code><span class="sig-paren">(</span><em>natoms</em>, <em>nmolecs</em>, <em>molec_idx</em>, <em>molec_nbonds</em>, <em>ndof_reduction_tra</em>, <em>ndof_reduction_rot</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#calc_ndof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.calc_ndof" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total / translational / rotational &amp; internal /
rotational / internal degrees of freedom per molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>natoms</strong> (<em>int</em>) &#8211; Total number of atoms in the system</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system</li>
<li><strong>molec_idx</strong> (<em>list of int</em>) &#8211; Index of first atom for every molecule</li>
<li><strong>molec_nbonds</strong> (<em>list of int</em>) &#8211; Number of bonds for every molecule</li>
<li><strong>ndof_reduction_tra</strong> (<em>int</em>) &#8211; Number of center-of-mass translational degrees of freedom to
remove. Default: 0.</li>
<li><strong>ndof_reduction_rot</strong> (<em>int</em>) &#8211; Number of center-of-mass rotational degrees of freedom to remove.
Default: 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ndof_molec</strong> &#8211; List of dictionaries containing the degrees of freedom for each molecule
Keys: [&#8216;tot&#8217;, &#8216;tra&#8217;, &#8216;rni&#8217;, &#8216;rot&#8217;, &#8216;int&#8217;]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.calc_kinetic_energy">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">calc_kinetic_energy</code><span class="sig-paren">(</span><em>pos</em>, <em>vel</em>, <em>masses</em>, <em>molec_idx</em>, <em>natoms</em>, <em>nmolecs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#calc_kinetic_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.calc_kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total / translational / rotational &amp; internal /
rotational / internal kinetic energy per molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos</strong> (<em>nd-array</em><em> (</em><em>natoms x 3</em><em>)</em><em></em>) &#8211; 2d array containing the positions of all atoms</li>
<li><strong>vel</strong> (<em>nd-array</em><em> (</em><em>natoms x 3</em><em>)</em><em></em>) &#8211; 2d array containing the velocities of all atoms</li>
<li><strong>masses</strong> (<em>nd-array</em><em> (</em><em>natoms x 1</em><em>)</em><em></em>) &#8211; 1d array containing the masses of all atoms</li>
<li><strong>molec_idx</strong> (<em>nd-array</em><em> (</em><em>nmolecs x 1</em><em>)</em><em></em>) &#8211; Index of first atom for every molecule</li>
<li><strong>natoms</strong> (<em>int</em>) &#8211; Total number of atoms in the system</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>kin</strong> &#8211; List of dictionaries containing the kinetic energies for each molecule
Keys: [&#8216;tot&#8217;, &#8216;tra&#8217;, &#8216;rni&#8217;, &#8216;rot&#8217;, &#8216;int&#8217;]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.group_kinetic_energy">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">group_kinetic_energy</code><span class="sig-paren">(</span><em>kin_molec</em>, <em>nmolecs</em>, <em>molec_group=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#group_kinetic_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.group_kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums up the partitioned kinetic energy for a
given group or the entire system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin_molec</strong> (<em>list of dict</em>) &#8211; Partitioned kinetic energies per molecule.</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system.</li>
<li><strong>molec_group</strong> (<em>iterable</em>) &#8211; Indeces of the group to be summed up. None defaults to all molecules
in the system. Default: None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>kin</strong> &#8211; Dictionary of partitioned kinetic energy for the group.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.group_ndof">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">group_ndof</code><span class="sig-paren">(</span><em>ndof_molec</em>, <em>nmolecs</em>, <em>molec_group=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#group_ndof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.group_ndof" title="Permalink to this definition">¶</a></dt>
<dd><p>Sums up the partitioned degrees of freedom for a
given group or the entire system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ndof_molec</strong> (<em>list of dict</em>) &#8211; Partitioned degrees of freedom per molecule.</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system.</li>
<li><strong>molec_group</strong> (<em>iterable</em>) &#8211; Indeces of the group to be summed up. None defaults to all molecules
in the system. Default: None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ndof</strong> &#8211; Dictionary of partitioned degrees of freedom for the group.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.calc_temperatures">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">calc_temperatures</code><span class="sig-paren">(</span><em>kin_molec</em>, <em>ndof_molec</em>, <em>nmolecs</em>, <em>molec_group=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#calc_temperatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.calc_temperatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the partitioned temperature for a
given group or the entire system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin_molec</strong> (<em>list of dict</em>) &#8211; Partitioned kinetic energies per molecule.</li>
<li><strong>ndof_molec</strong> (<em>list of dict</em>) &#8211; Partitioned degrees of freedom per molecule.</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system.</li>
<li><strong>molec_group</strong> (<em>iterable</em>) &#8211; Indeces of the group to be summed up. None defaults to all molecules
in the system. Default: None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>temp</strong> &#8211; Dictionary of partitioned temperatures for the group.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.test_mb_dist">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">test_mb_dist</code><span class="sig-paren">(</span><em>kin_molec</em>, <em>ndof_molec</em>, <em>nmolecs</em>, <em>temp</em>, <em>alpha</em>, <em>dict_keys</em>, <em>group=None</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#test_mb_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.test_mb_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if the partitioned kinetic energy trajectory of a group (or,
if group is None, of the entire system) are separately Maxwell-Boltzmann
distributed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin_molec</strong> (<em>list of list of dict</em>) &#8211; Partitioned kinetic energies per molecule for every frame.</li>
<li><strong>ndof_molec</strong> (<em>list of dict</em>) &#8211; Partitioned degrees of freedom per molecule.</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system.</li>
<li><strong>temp</strong> (<em>float</em>) &#8211; Target temperature of the simulation.</li>
<li><strong>alpha</strong> (<em>float</em>) &#8211; Confidence for Maxwell-Boltzmann test.</li>
<li><strong>dict_keys</strong> (<em>list</em>) &#8211; List of dictionary keys representing the partitions of the degrees
of freedom.</li>
<li><strong>group</strong> (<em>iterable</em>) &#8211; Indeces of the group to be tested. None defaults to all molecules
in the system. Default: None.</li>
<li><strong>verbosity</strong> (<em>int</em>) &#8211; Verbosity level, where 0 is quiet and 3 very chatty. Default: 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> &#8211; Number of partitions for which the Maxwell-Boltzmann distribution
hypthesis was rejected.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.test_temp_diff">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">test_temp_diff</code><span class="sig-paren">(</span><em>kin_molec</em>, <em>ndof_molec</em>, <em>nmolecs</em>, <em>dtemp</em>, <em>dict_keys</em>, <em>group=None</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#test_temp_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.test_temp_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if the partitioned temperatures (averaged over a trajectory)
of a group (or, if group is None, of the entire system) are within a
range <cite>dtemp</cite> of the total temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin_molec</strong> (<em>list of list of dict</em>) &#8211; Partitioned kinetic energies per molecule for every frame.</li>
<li><strong>ndof_molec</strong> (<em>list of dict</em>) &#8211; Partitioned degrees of freedom per molecule.</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system.</li>
<li><strong>dtemp</strong> (<em>float</em>) &#8211; Target temperature of the simulation.</li>
<li><strong>dict_keys</strong> (<em>list</em>) &#8211; List of dictionary keys representing the partitions of the degrees
of freedom.</li>
<li><strong>group</strong> (<em>iterable</em>) &#8211; Indeces of the group to be tested. None defaults to all molecules
in the system. Default: None.</li>
<li><strong>verbosity</strong> (<em>int</em>) &#8211; Verbosity level, where 0 is quiet and 3 very chatty. Default: 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> &#8211; Number of partitions for which the temperature ratio to the total
temperature was larger than dtemp.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.kinetic_energy.test_temp_diff_groups">
<code class="descclassname">physical_validation.util.kinetic_energy.</code><code class="descname">test_temp_diff_groups</code><span class="sig-paren">(</span><em>kin_molec</em>, <em>ndof_molec</em>, <em>nmolecs</em>, <em>group1</em>, <em>group2</em>, <em>dtemp</em>, <em>dict_keys</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/kinetic_energy.html#test_temp_diff_groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.kinetic_energy.test_temp_diff_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if the partitioned temperatures (averaged over a trajectory)
of two groups are (individually) within a range <cite>dtemp</cite> of each others.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kin_molec</strong> (<em>list of list of dict</em>) &#8211; Partitioned kinetic energies per molecule for every frame.</li>
<li><strong>ndof_molec</strong> (<em>list of dict</em>) &#8211; Partitioned degrees of freedom per molecule.</li>
<li><strong>nmolecs</strong> (<em>int</em>) &#8211; Total number of molecules in the system.</li>
<li><strong>group1</strong> (<em>iterable</em>) &#8211; Indeces of the first group to be compared.</li>
<li><strong>group2</strong> (<em>iterable</em>) &#8211; Indeces of the second group to be compared.</li>
<li><strong>dtemp</strong> (<em>float</em>) &#8211; Target temperature of the simulation.</li>
<li><strong>dict_keys</strong> (<em>list</em>) &#8211; List of dictionary keys representing the partitions of the degrees
of freedom.</li>
<li><strong>verbosity</strong> (<em>int</em>) &#8211; Verbosity level, where 0 is quiet and 3 very chatty. Default: 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>result</strong> &#8211; Number of partitions for which the temperature ratio to the total
temperature was larger than dtemp.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-physical_validation.util.timeseries">
<span id="physical-validation-util-timeseries-module"></span><h2>physical_validation.util.timeseries module<a class="headerlink" href="#module-physical_validation.util.timeseries" title="Permalink to this headline">¶</a></h2>
<p>A module for extracting uncorrelated samples from correlated timeseries data.</p>
<p>This module provides various tools that allow one to examine the correlation functions and
integrated autocorrelation times in correlated timeseries data, compute statistical inefficiencies,
and automatically extract uncorrelated samples for data analysis.</p>
<p>REFERENCES</p>
<p>[1] Shirts MR and Chodera JD. Statistically optimal analysis of samples from multiple equilibrium states.
J. Chem. Phys. 129:124105, 2008
<a class="reference external" href="http://dx.doi.org/10.1063/1.2978177">http://dx.doi.org/10.1063/1.2978177</a></p>
<p>[2] J. D. Chodera, W. C. Swope, J. W. Pitera, C. Seok, and K. A. Dill. Use of the weighted
histogram analysis method for the analysis of simulated and parallel tempering simulations.
JCTC 3(1):26-41, 2007.</p>
<dl class="exception">
<dt id="physical_validation.util.timeseries.ParameterError">
<em class="property">exception </em><code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">ParameterError</code><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#ParameterError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.ParameterError" title="Permalink to this definition">¶</a></dt>
<dd><p>An error in the input parameters has been detected.</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.statisticalInefficiency">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">statisticalInefficiency</code><span class="sig-paren">(</span><em>A_n</em>, <em>B_n=None</em>, <em>fast=False</em>, <em>mintime=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#statisticalInefficiency"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.statisticalInefficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the (cross) statistical inefficiency of (two) timeseries.</p>
<dl class="docutils">
<dt>REQUIRED ARGUMENTS</dt>
<dd>A_n (numpy array) - A_n[n] is nth value of timeseries A.  Length is deduced from vector.</dd>
<dt>OPTIONAL ARGUMENTS</dt>
<dd><dl class="first last docutils">
<dt>B_n (numpy array) - B_n[n] is nth value of timeseries B.  Length is deduced from vector.</dt>
<dd>If supplied, the cross-correlation of timeseries A and B will be estimated instead of the
autocorrelation of timeseries A.</dd>
<dt>fast (boolean) - if True, will use faster (but less accurate) method to estimate correlation</dt>
<dd>time, described in Ref. [1] (default: False)</dd>
<dt>mintime (int) - minimum amount of correlation function to compute (default: 3)</dt>
<dd>The algorithm terminates after computing the correlation time out to mintime when the
correlation function furst goes negative.  Note that this time may need to be increased
if there is a strong initial negative peak in the correlation function.</dd>
</dl>
</dd>
<dt>RETURNS</dt>
<dd><dl class="first last docutils">
<dt>g is the estimated statistical inefficiency (equal to 1 + 2 tau, where tau is the correlation time).</dt>
<dd>We enforce g &gt;= 1.0.</dd>
</dl>
</dd>
<dt>NOTES</dt>
<dd>The same timeseries can be used for both A_n and B_n to get the autocorrelation statistical inefficiency.
The fast method described in Ref [1] is used to compute g.</dd>
<dt>REFERENCES</dt>
<dd>[1] J. D. Chodera, W. C. Swope, J. W. Pitera, C. Seok, and K. A. Dill. Use of the weighted
histogram analysis method for the analysis of simulated and parallel tempering simulations.
JCTC 3(1):26-41, 2007.</dd>
</dl>
<p>EXAMPLES</p>
<p>Compute statistical inefficiency of timeseries data with known correlation time.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">testsystems</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_n</span> <span class="o">=</span> <span class="n">testsystems</span><span class="o">.</span><span class="n">generateCorrelatedTimeseries</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">statisticalInefficiency</span><span class="p">(</span><span class="n">A_n</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.statisticalInefficiencyMultiple">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">statisticalInefficiencyMultiple</code><span class="sig-paren">(</span><em>A_kn</em>, <em>fast=False</em>, <em>return_correlation_function=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#statisticalInefficiencyMultiple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.statisticalInefficiencyMultiple" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the statistical inefficiency from multiple stationary timeseries (of potentially differing lengths).</p>
<dl class="docutils">
<dt>REQUIRED ARGUMENTS</dt>
<dd>A_kn (Python list of numpy arrays) - A_kn[k] is the kth timeseries, and A_kn[k][n] is nth value of timeseries k.  Length is deduced from arrays.</dd>
<dt>OPTIONAL ARGUMENTS</dt>
<dd>fast can be set to True to give a less accurate but very quick estimate (default False)
return_correlation_function - if True, will also return estimates of normalized fluctuation correlation function that were computed (default: False)</dd>
<dt>RETURNS</dt>
<dd>g is the statistical inefficiency (equal to 1 + 2 tau, where tau is the integrated autocorrelation time).
Ct (list of tuples) - Ct[n] = (t, C) with time t and normalized correlation function estimate C is returned as well if return_correlation_function is set to True</dd>
<dt>NOTES</dt>
<dd>The autocorrelation of the timeseries is used to compute the statistical inefficiency.
The normalized fluctuation autocorrelation function is computed by averaging the unnormalized raw correlation functions.
The fast method described in Ref [1] is used to compute g.</dd>
<dt>REFERENCES</dt>
<dd>[1] J. D. Chodera, W. C. Swope, J. W. Pitera, C. Seok, and K. A. Dill. Use of the weighted
histogram analysis method for the analysis of simulated and parallel tempering simulations.
JCTC 3(1):26-41, 2007.</dd>
</dl>
<p>EXAMPLES</p>
<p>Estimate statistical efficiency from multiple timeseries of different lengths.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">testsystems</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="c1"># exponential relaxation time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_kn</span> <span class="o">=</span> <span class="p">[</span> <span class="n">testsystems</span><span class="o">.</span><span class="n">generateCorrelatedTimeseries</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_k</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">statisticalInefficiencyMultiple</span><span class="p">(</span><span class="n">A_kn</span><span class="p">)</span>
</pre></div>
</div>
<p>Also return the values of the normalized fluctuation autocorrelation function that were computed.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">g</span><span class="p">,</span> <span class="n">Ct</span><span class="p">]</span> <span class="o">=</span> <span class="n">statisticalInefficiencyMultiple</span><span class="p">(</span><span class="n">A_kn</span><span class="p">,</span> <span class="n">return_correlation_function</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.integratedAutocorrelationTime">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">integratedAutocorrelationTime</code><span class="sig-paren">(</span><em>A_n</em>, <em>B_n=None</em>, <em>fast=False</em>, <em>mintime=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#integratedAutocorrelationTime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.integratedAutocorrelationTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the integrated autocorrelation time.</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.integratedAutocorrelationTimeMultiple">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">integratedAutocorrelationTimeMultiple</code><span class="sig-paren">(</span><em>A_kn</em>, <em>fast=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#integratedAutocorrelationTimeMultiple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.integratedAutocorrelationTimeMultiple" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the integrated autocorrelation time from multiple timeseries.</p>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.normalizedFluctuationCorrelationFunction">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">normalizedFluctuationCorrelationFunction</code><span class="sig-paren">(</span><em>A_n</em>, <em>B_n=None</em>, <em>N_max=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#normalizedFluctuationCorrelationFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.normalizedFluctuationCorrelationFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the normalized fluctuation (cross) correlation function of (two) stationary timeseries.</p>
<p>C(t) = (&lt;A(t) B(t)&gt; - &lt;A&gt;&lt;B&gt;) / (&lt;AB&gt; - &lt;A&gt;&lt;B&gt;)</p>
<p>This may be useful in diagnosing odd time-correlations in timeseries data.</p>
<dl class="docutils">
<dt>REQUIRED ARGUMENTS</dt>
<dd>A_n[n] is nth value of timeseries A.  Length is deduced from vector.
B_n[n] is nth value of timeseries B.  Length is deduced from vector.</dd>
<dt>OPTIONAL ARGUMENTS</dt>
<dd>N_max - if specified, will only compute correlation function out to time lag of N_max</dd>
<dt>RETURNS</dt>
<dd>C_n[n] is the normalized fluctuation auto- or cross-correlation function for timeseries A(t) and B(t).</dd>
<dt>NOTES</dt>
<dd>The same timeseries can be used for both A_n and B_n to get the autocorrelation statistical inefficiency.
This procedure may be slow.
The statistical error in C_n[n] will grow with increasing n.  No effort is made here to estimate the uncertainty.</dd>
<dt>REFERENCES</dt>
<dd>[1] J. D. Chodera, W. C. Swope, J. W. Pitera, C. Seok, and K. A. Dill. Use of the weighted
histogram analysis method for the analysis of simulated and parallel tempering simulations.
JCTC 3(1):26-41, 2007.</dd>
</dl>
<p>EXAMPLES</p>
<p>Estimate normalized fluctuation correlation function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">testsystems</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_t</span> <span class="o">=</span> <span class="n">testsystems</span><span class="o">.</span><span class="n">generateCorrelatedTimeseries</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C_t</span> <span class="o">=</span> <span class="n">normalizedFluctuationCorrelationFunction</span><span class="p">(</span><span class="n">A_t</span><span class="p">,</span> <span class="n">N_max</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.normalizedFluctuationCorrelationFunctionMultiple">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">normalizedFluctuationCorrelationFunctionMultiple</code><span class="sig-paren">(</span><em>A_kn</em>, <em>B_kn=None</em>, <em>N_max=None</em>, <em>suppress_warning=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#normalizedFluctuationCorrelationFunctionMultiple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.normalizedFluctuationCorrelationFunctionMultiple" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the normalized fluctuation (cross) correlation function of (two) timeseries from multiple timeseries samples.</p>
<p>C(t) = (&lt;A(t) B(t)&gt; - &lt;A&gt;&lt;B&gt;) / (&lt;AB&gt; - &lt;A&gt;&lt;B&gt;)</p>
<p>This may be useful in diagnosing odd time-correlations in timeseries data.</p>
<dl class="docutils">
<dt>REQUIRED ARGUMENTS</dt>
<dd>A_kn (Python list of numpy arrays) - A_kn[k] is the kth timeseries, and A_kn[k][n] is nth value of timeseries k.  Length is deduced from arrays.
B_kn (Python list of numpy arrays) - B_kn[k] is the kth timeseries, and B_kn[k][n] is nth value of timeseries k.  B_kn[k] must have same length as A_kn[k]</dd>
<dt>OPTIONAL ARGUMENTS</dt>
<dd>N_max - if specified, will only compute correlation function out to time lag of N_max
suppress_warning - if we are calculating a lot of these, the warning could get a little annoying. Make it possible to suppress it, but don&#8217;t make that the default.</dd>
<dt>RETURNS</dt>
<dd>C_n[n] is the normalized fluctuation auto- or cross-correlation function for timeseries A(t) and B(t).</dd>
<dt>NOTES</dt>
<dd>The same timeseries can be used for both A_n and B_n to get the autocorrelation statistical inefficiency.
This procedure may be slow.
The statistical error in C_n[n] will grow with increasing n.  No effort is made here to estimate the uncertainty.</dd>
<dt>REFERENCES</dt>
<dd>[1] J. D. Chodera, W. C. Swope, J. W. Pitera, C. Seok, and K. A. Dill. Use of the weighted
histogram analysis method for the analysis of simulated and parallel tempering simulations.
JCTC 3(1):26-41, 2007.</dd>
</dl>
<p>EXAMPLES</p>
<p>Estimate a portion of the normalized fluctuation autocorrelation function from multiple timeseries of different length.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">testsystems</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="c1"># exponential relaxation time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_kn</span> <span class="o">=</span> <span class="p">[</span> <span class="n">testsystems</span><span class="o">.</span><span class="n">generateCorrelatedTimeseries</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_k</span> <span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C_n</span> <span class="o">=</span> <span class="n">normalizedFluctuationCorrelationFunctionMultiple</span><span class="p">(</span><span class="n">A_kn</span><span class="p">,</span> <span class="n">N_max</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="physical_validation.util.timeseries.subsampleCorrelatedData">
<code class="descclassname">physical_validation.util.timeseries.</code><code class="descname">subsampleCorrelatedData</code><span class="sig-paren">(</span><em>A_t</em>, <em>g=None</em>, <em>fast=False</em>, <em>conservative=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/physical_validation/util/timeseries.html#subsampleCorrelatedData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#physical_validation.util.timeseries.subsampleCorrelatedData" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the indices of an uncorrelated subsample of the data.</p>
<dl class="docutils">
<dt>REQUIRED ARGUMENTS</dt>
<dd>A_t (T array) - A_t[t] is the t-th value of timeseries A(t).  Length is deduced from vector.</dd>
<dt>OPTIONAL ARGUMENTS</dt>
<dd>g (float) - if provided, the statistical inefficiency g is used to subsample the timeseries &#8211; otherwise it will be computed (default: None)
fast (logical) - fast can be set to True to give a less accurate but very quick estimate (default: False)
conservative (logical) - if set to True, uniformly-spaced indices are chosen with interval ceil(g), where g is the statistical inefficiency.  Otherwise, indices are chosen non-uniformly with interval of approximately g in order to end up with approximately T/g total indices
verbose (logical) - if True, some output is printed</dd>
<dt>RETURNS</dt>
<dd>indices (list of int) - the indices of an uncorrelated subsample of the data</dd>
<dt>NOTES</dt>
<dd>The statistical inefficiency is computed with the function computeStatisticalInefficiency().</dd>
<dt>TODO</dt>
<dd>Instead of using regular stride, use irregular stride so more data can be fit in when g is non-integral.</dd>
</dl>
<p>EXAMPLES</p>
<p>Subsample a correlated timeseries to extract an effectively uncorrelated dataset.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">testsystems</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_t</span> <span class="o">=</span> <span class="n">testsystems</span><span class="o">.</span><span class="n">generateCorrelatedTimeseries</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span> <span class="c1"># generate a test correlated timeseries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">subsampleCorrelatedData</span><span class="p">(</span><span class="n">A_t</span><span class="p">)</span> <span class="c1"># compute indices of uncorrelated timeseries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_n</span> <span class="o">=</span> <span class="n">A_t</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="c1"># extract uncorrelated samples</span>
</pre></div>
</div>
<p>Extract uncorrelated samples from multiple timeseries data from the same process.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate multiple correlated timeseries data of different lengths.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">T_k</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T_k</span><span class="p">)</span> <span class="c1"># number of timeseries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="c1"># exponential relaxation time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_kt</span> <span class="o">=</span> <span class="p">[</span> <span class="n">testsystems</span><span class="o">.</span><span class="n">generateCorrelatedTimeseries</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_k</span> <span class="p">]</span> <span class="c1"># A_kt[k] is correlated timeseries k</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Estimate statistical inefficiency from all timeseries data.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">statisticalInefficiencyMultiple</span><span class="p">(</span><span class="n">A_kt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Count number of uncorrelated samples in each timeseries.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N_k</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="nb">len</span><span class="p">(</span><span class="n">subsampleCorrelatedData</span><span class="p">(</span><span class="n">A_t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">))</span> <span class="k">for</span> <span class="n">A_t</span> <span class="ow">in</span> <span class="n">A_kt</span> <span class="p">])</span> <span class="c1"># N_k[k] is the number of uncorrelated samples in timeseries k</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">N_k</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># total number of uncorrelated samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Subsample all trajectories to produce uncorrelated samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_kn</span> <span class="o">=</span> <span class="p">[</span> <span class="n">A_t</span><span class="p">[</span><span class="n">subsampleCorrelatedData</span><span class="p">(</span><span class="n">A_t</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">)]</span> <span class="k">for</span> <span class="n">A_t</span> <span class="ow">in</span> <span class="n">A_kt</span> <span class="p">]</span> <span class="c1"># A_kn[k] is uncorrelated subset of trajectory A_kt[t]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Concatenate data into one timeseries.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">N</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="c1"># A_n[n] is nth sample in concatenated set of uncorrelated samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A_n</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">N_k</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">A_kn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span> <span class="n">A_n</span><span class="p">[</span><span class="n">N_k</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">():</span><span class="n">N_k</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()]</span> <span class="o">=</span> <span class="n">A_kn</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="physical_validation.data.html" class="btn btn-neutral" title="physical_validation.data subpackage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Pascal T. Merz, Michael R. Shirts.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>